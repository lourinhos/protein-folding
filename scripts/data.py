import matplotlib.pyplot as plt
import json

plt.rcParams['mathtext.fontset'] = 'stix'
plt.rcParams['font.family'] = 'STIXGeneral'
# plt.title(r'ABC123 vs $\mathrm{ABC123}^{123}$')

step_sim = [0.13590952800893769, 0.1387816956437664, 0.14021068662251415, 0.14033152920925462, 0.1391881757150862, 0.13683745218862556, 0.13342062297233978, 0.12917544104822568, 0.12441156293193405, 0.1194549871904169, 0.11458816848106529, 0.1100141032723139, 0.10582950113083654, 0.10199642915433721, 0.09833988623158209, 0.09461518008365367, 0.09059941681935041, 0.08627075338574776, 0.08188478514806455, 0.0782206758599497, 0.07657007464735274, 0.07713342108376511, 0.0795983886615991, 0.08413225833454796, 0.09082138668087548, 0.09932197158183557, 0.10915277926670991, 0.11990529555394638, 0.13098143316983363, 0.14172200372942184, 0.15168038477112133, 0.16072599266115764, 0.16953980885378633, 0.17722324146552318, 0.1837802582544205, 0.18889067264170203, 0.19234369200906284, 0.19461822965863892, 0.196568650246848, 0.19873940671119927, 0.20136569603843557, 0.2047935361574861, 0.20940610466107892, 0.2146404215630563, 0.21932142780898564, 0.22264712687491964, 0.2244416241629887, 0.2247791108443229, 0.22366383193961448, 0.2211600428557533, 0.21757061609405534, 0.21355010237610858, 0.2101009621735876, 0.20835416070248516, 0.20876099285755645, 0.21297870484972825, 0.22097344028369936, 0.23164471730745403, 0.24405249005872107, 0.25762398247319274, 0.2715844580323939, 0.2851907676749303, 0.29793344191654736, 0.3093254613732498, 0.3188763703829823, 0.3261281331638668, 0.3307386498521588, 0.33256272521547264, 0.3316295803996154, 0.3277158115788995, 0.3212924927365173, 0.31300423694114193, 0.3036202715920754, 0.29382999257257897, 0.2842068609403447, 0.27539274220780197, 0.2678930913212292, 0.26182244715245895, 0.25736877718713597, 0.2548942501981522, 0.2545597569275591, 0.2559933869378308, 0.2587740630096117, 0.28239199923872715, 0.28628144123502247, 0.2870071851329746, 0.2863439564018937, 0.2842386639232064, 0.268003596163602, 0.24988225918451806, 0.24324539217432753, 0.23779319821113468, 0.23425560698595246, 0.23283998748425386, 0.2331909898065459, 0.23533543054195116, 0.2411296663682699, 0.2526091564390757, 0.26625884556148066, 0.28008608883760217, 0.3234463712677881, 0.3362690663523345, 0.35823381155729944, 0.3602267755219923, 0.370698866275725, 0.3796727412521884, 0.38691733220342917, 0.3922664925695428, 0.39589695902940003, 0.3984979916777767, 0.4009799489690406, 0.4047176993906204, 0.41076897994970724, 0.41848038810015703, 0.4237649579340962, 0.42555945495116854, 0.4227058549711373, 0.4139855440289308, 0.3996275462719275, 0.3795654869681102, 0.3542864932050433, 0.32521026709165346, 0.29519748554361785, 0.26679093781994934, 0.24333094126573127, 0.23946378534377044, 0.2605894542181922, 0.28647377930952034, 0.3109403427665096, 0.329948273420371, 0.34376290479093746, 0.340545738809152, 0.35334208224219915, 0.3510188209913774, 0.3447052797545825, 0.3353454925789144, 0.323912595613685, 0.31129233926565447, 0.29438240081537914, 0.25726014894039934, 0.24644305351880297, 0.2361098911442323, 0.22662526316911846, 0.21796413766253353, 0.20996144403840622, 0.20254966808129302, 0.19572847232198226, 0.18947355031622704, 0.18379065368926062, 0.1789520058553059, 0.17530437022546874, 0.17265123509763072, 0.17088710152573564, 0.1702085258267904, 0.1704909561650645, 0.1716157388330939, 0.1851006001510135, 0.1760315787205789, 0.18189218661201068, 0.1842363611604088, 0.18976913834067866, 0.19412794540195608, 0.1977518903324332, 0.2002288337592434, 0.20342036111724318, 0.19647480267102213, 0.20782402909211384, 0.2159504690368043, 0.211751878273519, 0.2104018850445527, 0.20825890573539618, 0.20536484369729982, 0.18918954161107474, 0.18318294361270807, 0.18192441890296582, 0.18341744658905182, 0.18481745504220604, 0.18945590791589584, 0.1820841461356812, 0.1820837475337659, 0.18914619954362308, 0.18752056049886773, 0.18538042525342852, 0.1827896269654467, 0.17997790092833785, 0.17824634547985338, 0.17731270162270366, 0.17643902849005477, 0.17547961234840556, 0.17420036409434972, 0.1735589332777374, 0.17317473978691456, 0.17187377131495066, 0.17016295682014454, 0.16817789428067645, 0.1659942791563072, 0.1636721425723301, 0.16126024597606164, 0.15879602894926437, 0.1563063459356034, 0.15345243967021635, 0.1444245297985894, 0.14192589766175367, 0.139774193568322, 0.13764558584301034, 0.13478819396711236, 0.13210417842667208, 0.12930928731517666, 0.12464501524605763, 0.11014048488778298, 0.10816440849677654, 0.10627956328542425, 0.1043083294721064, 0.10217918150323398, 0.10027655400258441, 0.09805949302769665, 0.09615087858693638, 0.09933494807237633, 0.09336147619175587, 0.0926221388279772, 0.09040904465318848, 0.0936358989806573, 0.09274796714321393, 0.09178947071418751, 0.08682053378864657, 0.08091642051413558, 0.08030237284104262, 0.07972476255021824, 0.07959428876138774, 0.07956390719532826, 0.0795526488261851, 0.079636420509358, 0.07984889250443028, 0.08013102510472292, 0.06775856055256205, 0.0671190128889893, 0.06650443748488365, 0.0659150276554535, 0.06534895159631308, 0.06481258285529475, 0.06440427751107398, 0.06279533348733983, 0.06254135468276636, 0.06235392365955602, 0.06223611618492644, 0.06997192689318717, 0.06349056783959267, 0.07735044442252714, 0.07713002648730666, 0.07687812898525156, 0.07672277637729799, 0.07677494690299828, 0.07708097749643726, 0.06444194679857736, 0.06486411338032416, 0.06547327981891377, 0.06234755745301151, 0.06311105433805088, 0.06386972572505982, 0.06459059201237419, 0.06548447894977887, 0.06646446507859294, 0.06757033954088305, 0.06869465102061487, 0.06981599335645737, 0.07091601385040812, 0.07197619266491315, 0.07297960772619563, 0.07330124373702514, 0.0738079598576141, 0.07425303868796884, 0.0746258743097457, 0.07492403185728129, 0.07514687016433612, 0.07529546252405823, 0.07537233609822425, 0.07538091048776911, 0.07532458768458168, 0.0752056740354366, 0.07502458662472336, 0.07477979582319687, 0.07446852413961648, 0.07408774808638371, 0.073634997312161, 0.07310873662215396, 0.07250840398817934, 0.07437807408091625, 0.07120808952654956, 0.07039470818662333, 0.06957203015411842, 0.06865175806234255, 0.06767035866187066, 0.06662856003073506, 0.0654239277131291, 0.06712122016832729, 0.06321943841377264, 0.06200633542412935, 0.06059250494620366, 0.06265779121059324, 0.05811665099964274, 0.05693311150844856, 0.05585872594009365, 0.059113323729032115, 0.054291536998286476, 0.05366212151155973, 0.053021415663197125, 0.05754257087075515, 0.05266836461314443, 0.057521610481061546, 0.0528387328302705, 0.05306783624612863, 0.0575505478085438, 0.057954752058585315, 0.05339603407371679, 0.05756757372275436, 0.05736834290872967, 0.057107942727534756, 0.056793534521202414, 0.056435421871922006, 0.056044926999026835, 0.055630738997799516, 0.053233701719051736, 0.05339020605913177, 0.05353536642654428, 0.053668900027494124, 0.05379001510601519, 0.0539225257564139, 0.05410856097172306, 0.05440602833746114, 0.054861414191406055, 0.055469938412494674, 0.056199028742827034, 0.057009904956194644, 0.06452065104500371, 0.06532554441325789, 0.06617736647887264, 0.06706588311093134, 0.06798036787583824, 0.06891223727867493, 0.07001388062862651, 0.071375807895841, 0.07275633476388575, 0.07416005792498245, 0.07560346225049425, 0.07711265500310108, 0.07870306932531206, 0.08035511844240643, 0.08202456859461686, 0.08367009692914201, 0.08526364680591872, 0.08678831306375528, 0.08823463089155485, 0.08959963396875581, 0.09089083127764874, 0.09212486839438654, 0.09327262645850683, 0.09422676822422575, 0.09493646873076994, 0.09540962213543037, 0.09569129805174402, 0.09584347571488779, 0.09590131055943421, 0.09587822937050038, 0.09578452003514407, 0.0956308154446626, 0.0954253183871282, 0.09517186370547172, 0.09495139731921504, 0.09479162080780146, 0.0946250748950522, 0.09443917354995465, 0.0942150330391533, 0.09392963530350444, 0.09355927827391754, 0.09308091408641798, 0.09250378286342055, 0.09179969479444167, 0.09094483978390495, 0.08993328780603162, 0.08876454957705038, 0.08744502041633723, 0.08598919678497445, 0.08441942200059217, 0.08276337308804567, 0.08077961008233861, 0.07680421966606799, 0.07592027279777334, 0.07535237813635166, 0.0751587442309184, 0.07534311338270193, 0.07585729740162699, 0.07663086494774644, 0.07759427332253127, 0.0786873396590578, 0.07986019878236685, 0.0810720199259969, 0.08228949329899493, 0.08348565765524162, 0.08463912555273291, 0.08573356152726481, 0.08675720046642332, 0.08770224093897509, 0.08856407782557126, 0.08934047815625967, 0.0900308805463574, 0.09063592034069877, 0.09115688881608108, 0.09159405054334052, 0.09191100257380515, 0.09199204214605866, 0.09191791310795881, 0.09168331105134511, 0.09133014265225753, 0.09096351676547049, 0.09066249684780188, 0.09040462144089861, 0.09015917555628898, 0.08991631375887095]
similarity = [14.502118341750116, 14.44988288258548, 14.396493383821403, 14.342564433346656, 14.288716034072094, 14.235545287320923, 14.183599652660872, 14.133347170355478, 14.085149409827567, 14.03924189103474, 13.99572681071083, 13.954582590630617, 13.915692875164499, 13.878894054241147, 13.844036089812478, 13.811043161540669, 13.77999502348229, 13.751116846494785, 13.7248111751619, 13.701640449223877, 13.682263663046955, 13.667387011034792, 13.65765087972519, 13.653538079389719, 13.655293064016401, 13.662840527004011, 13.675697098488378, 13.692841799315042, 13.71247067291304, 13.73148239497147, 13.744485060954766, 13.743743931655379, 13.739594013407572, 13.796282893945152, 13.823612178884128, 13.781837778886178, 13.707095307839491, 13.6174341706617, 13.520073147351946, 13.418282049528703, 13.313892030362204, 13.208206900808136, 13.102319923264078, 12.997278481603368, 12.894293707832754, 12.79495873541605, 12.700809068958453, 12.613018120255843, 12.532554242122131, 12.460196417836269, 12.39648465630358, 12.341657127115814, 12.295578936711095, 12.257660544361425, 12.227400083922456, 12.20450414165947, 12.18829123920944, 12.177837553593665, 12.17205232371517, 12.169570669883218, 12.168680682152575, 12.167365659759279, 12.163265447862619, 12.153760028701376, 12.136136927991332, 12.107824233272629, 12.066651861136968, 12.011103626956036, 11.940645317107943, 11.855445492635756, 11.756584405342748, 11.6460411316994, 11.526429073695363, 11.40066161560026, 11.271704550579928, 11.14231377653265, 11.014643970043952, 10.889910827206787, 10.76825308231802, 10.648940755365851, 10.530771897338036, 10.412439895466978, 10.292756985366044, 10.141920712737935, 9.988723936411974, 9.839112476432078, 9.695042447859812, 9.558559178103984, 9.439630735511157, 9.341547688319636, 9.2579469857583, 9.190177277415673, 9.139559619877854, 9.107037841321103, 9.093042771930127, 9.097502342300428, 9.119589848572545, 9.157595271505267, 9.2089506862405, 9.270395110714887, 9.363179542946922, 9.456936939894176, 9.558675212856679, 9.645400088669598, 9.721058195180792, 9.78061122471345, 9.820811605327345, 9.840113481639609, 9.839526671924839, 9.823231701156327, 9.797316136205518, 9.76763782786032, 9.732756013069874, 9.681546815034755, 9.608713809435178, 9.5153289616265, 9.403958945389235, 9.27746260932507, 9.14010319650279, 8.997402189820178, 8.855406281049538, 8.720400117272636, 8.598985592730164, 8.497661621918533, 8.421829068716812, 8.374911045657896, 8.35803154613635, 8.37021087386493, 8.408982482107804, 8.469793500571155, 8.549407431577436, 8.647833115296564, 8.752081957151029, 8.863494511566259, 8.978629713759716, 9.09415216557936, 9.206892636161689, 9.3139887270518, 9.415718462879845, 9.514009094617085, 9.60293186850579, 9.682085840562596, 9.751176577593881, 9.8098217647497, 9.857536001584652, 9.894487147200925, 9.921707906825624, 9.940098149484019, 9.950043511741043, 9.951846739584756, 9.946114297309508, 9.933304143643783, 9.913852640250639, 9.88814723762929, 9.85645880427672, 9.8190114656482, 9.765958763058388, 9.719172647982631, 9.671831300346325, 9.62069127210633, 9.566314640973848, 9.509715146770938, 9.451229098124164, 9.395420826495414, 9.33816011191838, 9.28211556341735, 9.221682395283752, 9.163399496698034, 9.108625931651593, 9.055050691779812, 9.004024007390326, 8.955896668361527, 8.92371792320787, 8.902746583119828, 8.886474681035418, 8.871260529156933, 8.857161750161918, 8.852721424161109, 8.852178454287733, 8.850596512941559, 8.843182150733435, 8.834552151384905, 8.824773920417966, 8.81386944135372, 8.802118577671738, 8.7916105574075, 8.783237042785297, 8.776910844791765, 8.772710239335687, 8.771098441896807, 8.772568537992823, 8.77562837906371, 8.780496257573118, 8.787307669298455, 8.796079837877636, 8.806736006417674, 8.819135731178921, 8.833112406981277, 8.848506664350534, 8.865187707178189, 8.882655159452, 8.90352042871117, 8.925243469748645, 8.948164719810492, 8.972237557546231, 8.996941084214766, 9.022354897347778, 9.048246546777653, 9.073722372999704, 9.094495359023849, 9.113709736036686, 9.130742376372561, 9.145152910874083, 9.156482692273878, 9.164268255735037, 9.168371103282952, 9.168535393285094, 9.158622387607865, 9.150198073299471, 9.138189411091634, 9.122069206305927, 9.095409429331026, 9.065027004936251, 9.031283520768635, 9.000962299091572, 8.987372706506697, 8.971020778837055, 8.951781256553277, 8.930113808514744, 8.90633056840873, 8.880646981170084, 8.853274222671901, 8.824447082468431, 8.794430621112188, 8.77178635192862, 8.748446019542746, 8.724536749753556, 8.700180601878866, 8.675498910889253, 8.650614672501336, 8.625560088132369, 8.601332650929805, 8.577229550075112, 8.553364137349872, 8.529850269348385, 8.505655198370658, 8.482865377371853, 8.455026633583383, 8.429788009545788, 8.407535534284344, 8.388603585175872, 8.37333518603476, 8.36215144623281, 8.354780974342384, 8.349332312192383, 8.34592424605236, 8.345699560049258, 8.346742873052557, 8.349624618906075, 8.354893911595434, 8.36195459097308, 8.370853937322948, 8.381664377865906, 8.394388313531564, 8.409020911478237, 8.425544746101668, 8.443931969937283, 8.46414654008109, 8.486726649879884, 8.51048996250717, 8.535387099359552, 8.561381736700307, 8.58843170707361, 8.616489299685824, 8.645501742998333, 8.675411784064028, 8.706158272880417, 8.737676701709582, 8.769899667540502, 8.802757231506854, 8.836177148595212, 8.870084939923366, 8.904403786361913, 8.93905424578894, 8.973953836990162, 9.009016572856554, 9.043985261731802, 9.079223592827736, 9.114472162274506, 9.149648709478287, 9.184453874195407, 9.218751351626185, 9.252385126797257, 9.285101710929583, 9.316414031847918, 9.346814135165323, 9.375597593149912, 9.40226633742389, 9.425793565482396, 9.446574902114866, 9.463278376129656, 9.474959452802867, 9.478954610719827, 9.477667814035959, 9.46975097033476, 9.456106087340299, 9.433882227732978, 9.412288924659691, 9.384053756576545, 9.359272698975602, 9.333876296244002, 9.303939946863256, 9.274025983470423, 9.249171728240412, 9.220669614808521, 9.193118874952374, 9.166663022087937, 9.141418706468379, 9.117487534118588, 9.094955474551336, 9.073893367863421, 9.056405243608364, 9.039920926952169, 9.024487825584625, 9.01015246501991, 8.996966705453895, 8.984981803704782, 8.97424459054067, 8.964796803161146, 8.956674473590052, 8.949905753956788, 8.944470434305053, 8.940424078428624, 8.940392890290491, 8.94187050637271, 8.944807357103723, 8.949143104877047, 8.954806532161987, 8.961717302756728, 8.9698444451333, 8.97916257599799, 8.989552611617103, 9.000895175919078, 9.013074345320884, 9.025981873723993, 9.039520043247173, 9.053601725413873, 9.068146581246564, 9.08307299351129, 9.098286412778558, 9.113665874052407, 9.12905089180478, 9.14423095459764, 9.158942421008893, 9.172886220122896, 9.185752949517719, 9.197179424901543, 9.206752079081994, 9.21410954576883, 9.218992417987762, 9.221218900718931, 9.220662656494804, 9.217256325193981, 9.210994813423392, 9.201930682213735, 9.190165205090837, 9.175838335731134, 9.159409157475247, 9.141277365071645, 9.12157529660846, 9.100438839570526, 9.078008695401415, 9.054432346180686, 9.02986626699693, 9.004483605918011, 8.978468548618618, 8.95201155995135, 8.925317747005177, 8.898607807615358, 8.872117085402595, 8.846094427605323, 8.820801904022076, 8.796517010421505, 8.773537963563912, 8.75245842334038, 8.73785378872281, 8.725294283675893, 8.714971705165512, 8.707047664328929, 8.701644051939436, 8.698837431067979, 8.698657383633318, 8.701088020081796, 8.706071756435945, 8.713514613903246, 8.723292450395826, 8.735257631733683, 8.74924571722592, 8.765081804125462, 8.78258625934975, 8.801579654839294, 8.821886799415894, 8.843339814252795, 8.86578022750444, 8.889060069022307, 8.913041937264113, 8.937598004180336, 8.962607948202468, 8.987934371979762, 9.013381288223103, 9.038835403989042, 9.064187963283468, 9.089335434191751, 9.11418137090472, 9.138637483608408, 9.162620985359418, 9.186046411532491, 9.208812041638422] 

plt.plot(step_sim)
plt.ylim(0, max(step_sim) * 1.2)
plt.xlabel('Iterations')
plt.ylabel('Distance [Å]')
# plt.xticks([])
# plt.yticks([])
plt.title('Average distance of each atom to previous iteration')
plt.savefig('results/step_similarity.svg')
plt.show()
plt.close()

plt.plot(similarity)
plt.ylim(0, max(similarity) * 1.2)
plt.xlabel('Iterations')
plt.ylabel('Distance [Å]')
# plt.xticks([])
# plt.yticks([])
plt.title('Average distance of each atom to reference protein')
plt.savefig('results/ref_similarity.svg')
plt.show()
plt.close()

# with open('results/raw.json', 'r') as f:
#   data = json.load(f)
#   data['new'] = {
#       'ref_similarity': similarity,
#       'step_similarity': step_sim
#   }

# with open('results/raw.json', 'w') as f:
#   json.dump(data, f, indent=2)
